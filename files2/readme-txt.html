<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Main Page/Introduction - freemco NES corelib</title><link rel="stylesheet" type="text/css" href="../styles/main.css"><script language=JavaScript src="../javascript/main.js"></script><script language=JavaScript src="../javascript/prettify.js"></script><script language=JavaScript src="../javascript/searchdata.js"></script></head><body class="ContentPage" onLoad="NDOnLoad();prettyPrint();"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version 1.52 -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->




<div id=Content><div class="CSection"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="Main_Page/Introduction"></a>Main Page/<wbr>Introduction</h1><div class=CBody><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SMain"><td class=SEntry><a href="#Main_Page/Introduction" >Main Page/<wbr>Introduction</a></td><td class=SDescription></td></tr><tr class="SSection"><td class=SEntry><a href="#Introduction" >Introduction</a></td><td class=SDescription>The freemco NES corelib is a set of assembly language routines meant to help make it easier to create a NES game/utility/etc.</td></tr><tr class="SSection"><td class=SEntry><a href="#Prerequisites" >Prerequisites</a></td><td class=SDescription>A list of tools either required or recommended for using the freemco NES corelib.</td></tr><tr class="SSection"><td class=SEntry><a href="#Memory_Usage" >Memory Usage</a></td><td class=SDescription>As with any library, a number of things need to be kept track of, meaning there&rsquo;s less room for your game. </td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#Zero_Page_Variables" >Zero Page Variables</a></td><td class=SDescription>Zero page ($00-$FF) is the best place to put variables that need to be accessed often. </td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#The_Stack($0100-$01FF)" >The Stack ($0100-$01FF)</a></td><td class=SDescription>Depending on how much you use the stack, you might be able to get away with putting some variables in the top few addresses (e.g. </td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#OAM(Sprite)Data($0200-$02FF)" >OAM (Sprite) Data ($0200-$02FF)</a></td><td class=SDescription>While the OAM data can technically live anywhere within $0000-$07FF, NES games typically put the OAM data just after the stack. </td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#Everywhere_else($0300-$07FF)" >Everywhere else ($0300-$07FF)</a></td><td class=SDescription>The details of this section are to be determined, but typically this area is used for any variables your game needs.</td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#Variables" >Variables</a></td><td class=SDescription></td></tr><tr class="SVariable SIndent2 SMarked"><td class=SEntry><a href="#Temporary_Variables($00-$0F)" >Temporary Variables ($00-$0F)</a></td><td class=SDescription>The temporary variables at $00-$0F can be used for any purpose, as long as you&rsquo;re aware that other routines may be using them. </td></tr><tr class="SVariable SIndent2"><td class=SEntry><a href="#System_Variables($10-$2F)" >System Variables ($10-$2F)</a></td><td class=SDescription>In addition to temporary variables, the freemco NES corelib also sets up a number of variables that a game will typically need.</td></tr><tr class="SVariable SIndent2 SMarked"><td class=SEntry><a href="#Undefined($30-$BF)" >Undefined ($30-$BF)</a></td><td class=SDescription>The range of $30-$BF is not used by the corelib, meaning you can abuse it to your heart&rsquo;s content.</td></tr><tr class="SVariable SIndent2"><td class=SEntry><a href="#CHR-RAM_Tile_Decompression($C0-$DF)" >CHR-RAM Tile Decompression ($C0-$DF)</a></td><td class=SDescription>The decompression code for CHR-RAM uses a number of variables. </td></tr><tr class="SVariable SIndent2 SMarked"><td class=SEntry><a href="#Mapper-specific($E0-$EF)" >Mapper-specific ($E0-$EF?)</a></td><td class=SDescription>Each mapper has its own way of operating, which means more variables. </td></tr><tr class="SSection"><td class=SEntry><a href="#Headers_and_Mappers,oh_my!" >Headers and Mappers, oh my!</a></td><td class=SDescription>In order to make a NES game/program/whatever, you&rsquo;re going to need to determine what type of cart to create. </td></tr><tr class="SGeneric SIndent1 SMarked"><td class=SEntry><a href="#Mappers" >Mappers</a></td><td class=SDescription>The mapper is the heart of the cartridge. </td></tr><tr class="SGeneric SIndent1"><td class=SEntry><a href="#Headers" >Headers</a></td><td class=SDescription>Most NES emulators require your ROM to have a header. </td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Introduction"></a>Introduction</h2><div class=CBody><p>The freemco NES corelib is a set of assembly language routines meant to help make it easier to create a NES game/utility/etc.</p></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Prerequisites"></a>Prerequisites</h2><div class=CBody><p>A list of tools either required or recommended for using the freemco NES corelib.</p><ul><li><b>Assembler</b>: Either <b>asm6</b> or <b>asm6f</b> can be used. asm6f is only required for FCEUX .nl export, so if you&rsquo;re not using that, you can use the original version.&nbsp; If you want to write your own linker scripts, I guess you could use ca65 as well, but no support will be given for that.</li><li><b>Tile Compressor</b>: <a href="http://forums.nesdev.com/viewtopic.php?f=2&amp;t=5860" class=LURL target=_top>tokumaru&rsquo;s tile compression utility</a></li><li><b>Nametable Layout Tool</b>: <a href="http://shiru.untergrund.net/software.shtml" class=LURL target=_top>shiru&rsquo;s NES Screen Tool</a></li></ul></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Memory_Usage"></a>Memory Usage</h2><div class=CBody><p>As with any library, a number of things need to be kept track of, meaning there&rsquo;s less room for your game.&nbsp; The freemco NES corelib tries to keep this space to a minimum.</p><p>Please see ram.example for an example RAM layout for a freemco NES corelib project.</p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SGeneric"><td class=SEntry><a href="#Zero_Page_Variables" >Zero Page Variables</a></td><td class=SDescription>Zero page ($00-$FF) is the best place to put variables that need to be accessed often. </td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#The_Stack($0100-$01FF)" >The Stack ($0100-$01FF)</a></td><td class=SDescription>Depending on how much you use the stack, you might be able to get away with putting some variables in the top few addresses (e.g. </td></tr><tr class="SGeneric"><td class=SEntry><a href="#OAM(Sprite)Data($0200-$02FF)" >OAM (Sprite) Data ($0200-$02FF)</a></td><td class=SDescription>While the OAM data can technically live anywhere within $0000-$07FF, NES games typically put the OAM data just after the stack. </td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#Everywhere_else($0300-$07FF)" >Everywhere else ($0300-$07FF)</a></td><td class=SDescription>The details of this section are to be determined, but typically this area is used for any variables your game needs.</td></tr><tr class="SGroup"><td class=SEntry><a href="#Variables" >Variables</a></td><td class=SDescription></td></tr><tr class="SVariable SIndent1 SMarked"><td class=SEntry><a href="#Temporary_Variables($00-$0F)" >Temporary Variables ($00-$0F)</a></td><td class=SDescription>The temporary variables at $00-$0F can be used for any purpose, as long as you&rsquo;re aware that other routines may be using them. </td></tr><tr class="SVariable SIndent1"><td class=SEntry><a href="#System_Variables($10-$2F)" >System Variables ($10-$2F)</a></td><td class=SDescription>In addition to temporary variables, the freemco NES corelib also sets up a number of variables that a game will typically need.</td></tr><tr class="SVariable SIndent1 SMarked"><td class=SEntry><a href="#Undefined($30-$BF)" >Undefined ($30-$BF)</a></td><td class=SDescription>The range of $30-$BF is not used by the corelib, meaning you can abuse it to your heart&rsquo;s content.</td></tr><tr class="SVariable SIndent1"><td class=SEntry><a href="#CHR-RAM_Tile_Decompression($C0-$DF)" >CHR-RAM Tile Decompression ($C0-$DF)</a></td><td class=SDescription>The decompression code for CHR-RAM uses a number of variables. </td></tr><tr class="SVariable SIndent1 SMarked"><td class=SEntry><a href="#Mapper-specific($E0-$EF)" >Mapper-specific ($E0-$EF?)</a></td><td class=SDescription>Each mapper has its own way of operating, which means more variables. </td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Zero_Page_Variables"></a>Zero Page Variables</h3><div class=CBody><p>Zero page ($00-$FF) is the best place to put variables that need to be accessed often.&nbsp; The freemco NES corelib takes up a bit of space at the beginning of zero page for its own purposes.</p></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="The_Stack($0100-$01FF)"></a>The Stack ($0100-$01FF)</h3><div class=CBody><p>Depending on how much you use the stack, you might be able to get away with putting some variables in the top few addresses (e.g.&nbsp; $0100-$0120).</p></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="OAM(Sprite)Data($0200-$02FF)"></a>OAM (Sprite) Data ($0200-$02FF)</h3><div class=CBody><p>While the OAM data can technically live anywhere within $0000-$07FF, NES games typically put the OAM data just after the stack.&nbsp; The corelib follows this convention.</p></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Everywhere_else($0300-$07FF)"></a>Everywhere else ($0300-$07FF)</h3><div class=CBody><p>The details of this section are to be determined, but typically this area is used for any variables your game needs.</p></div></div></div>

<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="Variables"></a>Variables</h3></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="Temporary_Variables($00-$0F)"></a>Temporary Variables ($00-$0F)</h3><div class=CBody><p>The temporary variables at $00-$0F can be used for any purpose, as long as you&rsquo;re aware that other routines may be using them.&nbsp; The names for these variables are tmp00 to tmp0F.</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="System_Variables($10-$2F)"></a>System Variables ($10-$2F)</h3><div class=CBody><p>In addition to temporary variables, the freemco NES corelib also sets up a number of variables that a game will typically need.</p><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry><a name="vblanked"></a>vblanked</td><td class=CDLDescription>&rdquo;in VBlank&rdquo; indicator</td></tr><tr><td class=CDLEntry><a name="frameCount"></a>frameCount</td><td class=CDLDescription>Current number of frames run (two bytes)</td></tr><tr><td class=CDLEntry><a name="int_ppuCtrl"></a>int_ppuCtrl</td><td class=CDLDescription>internal copy of PPU_CTRL</td></tr><tr><td class=CDLEntry><a name="int_ppuMask"></a>int_ppuMask</td><td class=CDLDescription>internal copy of PPU_MASK</td></tr><tr><td class=CDLEntry><a name="int_ppuStatus"></a>int_ppuStatus</td><td class=CDLDescription>internal PPU_STATUS read</td></tr><tr><td class=CDLEntry><a name="int_scrollX"></a>int_scrollX</td><td class=CDLDescription>Internal PPU_SCROLL (first write)</td></tr><tr><td class=CDLEntry><a name="int_scrollY"></a>int_scrollY</td><td class=CDLDescription>Internal PPU_SCROLL (second write)</td></tr><tr><td class=CDLEntry><a name="int_last4016"></a>int_last4016</td><td class=CDLDescription>Last write to $4016/JOYSTICK1</td></tr><tr><td class=CDLEntry><a name="pad1Trigger"></a>pad1Trigger</td><td class=CDLDescription>Button trigger status for controller 1</td></tr><tr><td class=CDLEntry><a name="pad2Trigger"></a>pad2Trigger</td><td class=CDLDescription>Button trigger status for controller 2</td></tr><tr><td class=CDLEntry><a name="pad3Trigger"></a>pad3Trigger</td><td class=CDLDescription>(Optional) Button trigger status for controller 3</td></tr><tr><td class=CDLEntry><a name="pad4Trigger"></a>pad4Trigger</td><td class=CDLDescription>(Optional) Button trigger status for controller 4</td></tr><tr><td class=CDLEntry><a name="pad1State"></a>pad1State</td><td class=CDLDescription>Button data for controller 1</td></tr><tr><td class=CDLEntry><a name="pad2State"></a>pad2State</td><td class=CDLDescription>Button data for controller 2</td></tr><tr><td class=CDLEntry><a name="pad3State"></a>pad3State</td><td class=CDLDescription>(Optional) Button data for controller 3</td></tr><tr><td class=CDLEntry><a name="pad4State"></a>pad4State</td><td class=CDLDescription>(Optional) Button data for controller 4</td></tr></table></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="Undefined($30-$BF)"></a>Undefined ($30-$BF)</h3><div class=CBody><p>The range of $30-$BF is not used by the corelib, meaning you can abuse it to your heart&rsquo;s content.</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="CHR-RAM_Tile_Decompression($C0-$DF)"></a>CHR-RAM Tile Decompression ($C0-$DF)</h3><div class=CBody><p>The decompression code for CHR-RAM uses a number of variables.&nbsp; See <a href="ppu/decomp_tiles-asm.html#ppu/decomp_tiles.asm" class=LFile id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">ppu/decomp_tiles.asm</a> for a full list.</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="Mapper-specific($E0-$EF)"></a>Mapper-specific ($E0-$EF?)</h3><div class=CBody><p>Each mapper has its own way of operating, which means more variables.&nbsp; Each mapper is different, so you&rsquo;ll have to see the documentation for the mapper you&rsquo;re using in order to find out what variables are available.</p></div></div></div>

<div class="CSection"><div class=CTopic><h2 class=CTitle><a name="Headers_and_Mappers,oh_my!"></a>Headers and Mappers, oh my!</h2><div class=CBody><p>In order to make a NES game/program/whatever, you&rsquo;re going to need to determine what type of cart to create.&nbsp; In addition, the ROM image you create for emulators will (typically) need a header in order for the game to run.</p><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SGeneric"><td class=SEntry><a href="#Mappers" >Mappers</a></td><td class=SDescription>The mapper is the heart of the cartridge. </td></tr><tr class="SGeneric SMarked"><td class=SEntry><a href="#Headers" >Headers</a></td><td class=SDescription>Most NES emulators require your ROM to have a header. </td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Mappers"></a>Mappers</h3><div class=CBody><p>The mapper is the heart of the cartridge.&nbsp; It can allow for bankswitching of program data and character data, among many other things.&nbsp; Choosing the right mapper is largely a function of what your game/utility/etc. needs to do.</p><h4 class=CHeading>Some commonly used mappers:</h4><ul><li><b>NROM</b>, etc.&nbsp; (iNES mapper 000) e.g.&nbsp; Balloon Fight, Bomberman, Super Mario Bros.</li><li><b>MMC1</b> (iNES mapper 001) e.g.&nbsp; Blaster Master, Dr. Mario, The Legend of Zelda (U), Mega Man 2...</li><li><b>UxROM</b> (iNES mapper 002) e.g.&nbsp; Contra (U), DuckTales, Mega Man</li><li><b>CNROM</b> (iNES mapper 003) e.g.&nbsp; Arkanoid, Gradius, Paperboy</li><li><b>MMC3</b>  (iNES mapper 004) e.g.&nbsp; Batman, Kirby&rsquo;s Adventure, Mega Man 3-6, Super Mario Bros.&nbsp; 3...</li></ul></div></div></div>

<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="Headers"></a>Headers</h3><div class=CBody><p>Most NES emulators require your ROM to have a header.&nbsp; The header is a set of bytes identifying the cartridge setup, including the mapper used, the sizes for PRG and CHR, and so on.</p></div></div></div>

</div><!--Content-->


<div id=Footer>freemco NES corelib&nbsp; &middot;&nbsp; Generated on 2016/02/27 (27 February)&nbsp; &middot;&nbsp; <a href="http://www.naturaldocs.org">Generated by Natural Docs</a></div><!--Footer-->


<div id=Menu><div class=MTitle>freemco NES corelib</div><div class=MEntry><div class=MFile id=MSelected>Main Page/<wbr>Introduction</div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent1')">IO</a><div class=MGroupContent id=MGroupContent1><div class=MEntry><div class=MText>Input/Output devices</div></div><div class=MEntry><div class=MFile><a href="io-asm.html">io.asm</a></div></div><div class=MEntry><div class=MFile><a href="io/keyboard_fb-asm.html">io/<wbr>keyboard_fb.asm</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent2')">Mappers</a><div class=MGroupContent id=MGroupContent2><div class=MEntry><div class=MText>Cartridge mappers</div></div><div class=MEntry><div class=MFile><a href="mappers/MMC1-asm.html">MMC1.asm</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent3')">PPU</a><div class=MGroupContent id=MGroupContent3><div class=MEntry><div class=MText>Graphics-related</div></div><div class=MEntry><div class=MFile><a href="ppu-asm.html">ppu.asm</a></div></div><div class=MEntry><div class=MFile><a href="ppu/decomp_tiles-asm.html">ppu/<wbr>decomp_tiles.asm</a></div></div><div class=MEntry><div class=MFile><a href="ppu/oam-asm.html">ppu/<wbr>oam.asm</a></div></div><div class=MEntry><div class=MFile><a href="ppu/palette-asm.html">ppu/<wbr>palette.asm</a></div></div><div class=MEntry><div class=MFile><a href="ppu/rle-asm.html">ppu/<wbr>rle.asm</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent4')">Other</a><div class=MGroupContent id=MGroupContent4><div class=MEntry><div class=MText>Everything else</div></div><div class=MEntry><div class=MFile><a href="math-asm.html">math.asm</a></div></div><div class=MEntry><div class=MFile><a href="nes-inc.html">nes.inc</a></div></div><div class=MEntry><div class=MFile><a href="util-asm.html">util.asm</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent5')">Index</a><div class=MGroupContent id=MGroupContent5><div class=MEntry><div class=MIndex><a href="../index/General.html">Everything</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Constants.html">Constants</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Files.html">Files</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Functions.html">Functions</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Macros.html">Macros</a></div></div><div class=MEntry><div class=MIndex><a href="../index/Variables.html">Variables</a></div></div></div></div></div><script type="text/javascript"><!--
var searchPanel = new SearchPanel("searchPanel", "HTML", "../search");
--></script><div id=MSearchPanel class=MSearchPanelInactive><input type=text id=MSearchField value=Search onFocus="searchPanel.OnSearchFieldFocus(true)" onBlur="searchPanel.OnSearchFieldFocus(false)" onKeyUp="searchPanel.OnSearchFieldChange()"><select id=MSearchType onFocus="searchPanel.OnSearchTypeFocus(true)" onBlur="searchPanel.OnSearchTypeFocus(false)" onChange="searchPanel.OnSearchTypeChange()"><option  id=MSearchEverything selected value="General">Everything</option><option value="Constants">Constants</option><option value="Files">Files</option><option value="Functions">Functions</option><option value="Macros">Macros</option><option value="Variables">Variables</option></select></div></div><!--Menu-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CFile>PRG-ROM to CHR-RAM tile decompressor</div></div><!--END_ND_TOOLTIPS-->




<div id=MSearchResultsWindow><iframe src="" frameborder=0 name=MSearchResults id=MSearchResults></iframe><a href="javascript:searchPanel.CloseResultsWindow()" id=MSearchResultsWindowClose>Close</a></div>


<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>